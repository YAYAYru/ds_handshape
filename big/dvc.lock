schema: '2.0'
stages:
  json2csv:
    cmd: python3 src/stages/json2csv.py params.yaml
    deps:
    - path: data/interim/sl_hand_json
      md5: 7ea60969d88183efbf3c200af30a1b71.dir
      size: 472771937
      nfiles: 6321
    - path: data/raw/sl_hand_label
      md5: 618e55b4c611188e975317ce37e9441b.dir
      size: 383240
      nfiles: 15
    - path: src/stages/json2csv.py
      md5: 8f36a7a0306756ba350cf1daf1663563
      size: 3153
    outs:
    - path: data/interim/xyz_63f.csv
      md5: 729322b6c584b588291f6841be226140
      size: 450963031
  xyz2angle:
    cmd: python3 src/stages/xyz2angle.py params.yaml
    deps:
    - path: data/interim/xyz_63f.csv
      md5: 729322b6c584b588291f6841be226140
      size: 450963031
    - path: src/stages/xyz2angle.py
      md5: 5f6315adcd759b5dbea0fc8f408d0347
      size: 1093
    outs:
    - path: data/interim/angle_19f.csv
      md5: 7acd831f9aa8adbebe9c327aaf1b1e6e
      size: 143393352
  select_label:
    cmd: python3 src/stages/select_label.py params.yaml
    deps:
    - path: data/interim/angle_19f.csv
      md5: 7acd831f9aa8adbebe9c327aaf1b1e6e
      size: 143393352
    - path: src/stages/select_label.py
      md5: 74a9bb8f9c698804e0e7ce5a85d618e0
      size: 1061
    params:
      params.yaml:
        select_label.list_fsw_orientation:
        - '28'
        - '20'
        - '21'
        - '29'
        - 2f
        - '27'
        - 2a
        - '22'
        - '26'
        - 2e
    outs:
    - path: data/interim/angle_19f_handshape.csv
      md5: 595864f2a50e16c60705c396cce39a30
      size: 26172372
  split_trainval_test:
    cmd: python3 src/stages/split_trainval_test.py params.yaml
    deps:
    - path: data/interim/train_val_test_balance.csv
      md5: a6048a8f9429c1fc56f08f1ecb5f2d7d
      size: 18888758
    - path: src/stages/split_trainval_test.py
      md5: 70d9e4966aefdc4f364b6f47ce9895ab
      size: 1722
    params:
      params.yaml:
        split_trainval_test.random_state: 42
        split_trainval_test.test_size: 0.1
    outs:
    - path: data/processed/test.csv
      md5: 5b48d41ac38e832f575e82a741b6b558
      size: 1888968
    - path: data/processed/train_val.csv
      md5: 303733e8ec7fc4d3dec05eeaa0c05dd0
      size: 17000067
  train_val_split:
    cmd: python3 src/stages/train_val_split.py params.yaml
    deps:
    - path: data/processed/train_val.csv
      md5: 303733e8ec7fc4d3dec05eeaa0c05dd0
      size: 17000067
    - path: src/stages/train_val_split.py
      md5: 3edb888dfdd4cf9135cc03c67860ee9a
      size: 1513
    params:
      params.yaml:
        train_val_split.random_state: 42
        train_val_split.val_size: 0.1
    outs:
    - path: data/processed/train.csv
      md5: 8431c71e78b234e07bc1581cd420cc50
      size: 15299966
    - path: data/processed/val.csv
      md5: 81c8d8eb1ba2fb865b239fd7758327a0
      size: 1700378
  select_features:
    cmd: python3 src/stages/select_features.py params.yaml
    deps:
    - path: data/interim/test2.csv
      md5: 513bcef6a9da6cc91534b35130f972b5
      size: 1664613
    - path: data/processed/test.csv
      md5: 5b48d41ac38e832f575e82a741b6b558
      size: 1888968
    - path: data/processed/train.csv
      md5: 8431c71e78b234e07bc1581cd420cc50
      size: 15299966
    - path: data/processed/val.csv
      md5: 81c8d8eb1ba2fb865b239fd7758327a0
      size: 1700378
    - path: src/stages/select_features.py
      md5: b869d067c8e9682d55f348e31a474e15
      size: 2556
    outs:
    - path: data/processed/test2_x.npy
      md5: 0ad4cce2a475e7cf300649df96b2614c
      size: 1418288
    - path: data/processed/test2_y.npy
      md5: 686ebec95d4f9c235509b9792f7cf49f
      size: 19357
    - path: data/processed/test_x.npy
      md5: d1cdcd7086c5f40cc03042ff4ac7f8c7
      size: 2112776
    - path: data/processed/test_y.npy
      md5: b1d20d41787b0d2b1e8ba8e667d47fee
      size: 28503
    - path: data/processed/train_x.npy
      md5: a12cc638d1bb3b995d1602d9a208f88f
      size: 17112440
    - path: data/processed/train_y.npy
      md5: 8705042860886878f85685e9f2189ec2
      size: 227255
    - path: data/processed/val_x.npy
      md5: 93f8d456f4d554d555ee1e0e48254991
      size: 1901648
    - path: data/processed/val_y.npy
      md5: 9266daa46be4222a08e5249ccc572be4
      size: 25723
  to_categorical:
    cmd: python3 src/stages/to_categorical.py params.yaml
    deps:
    - path: data/processed/test2_y.npy
      md5: 686ebec95d4f9c235509b9792f7cf49f
      size: 19357
    - path: data/processed/test_y.npy
      md5: b1d20d41787b0d2b1e8ba8e667d47fee
      size: 28503
    - path: data/processed/train_y.npy
      md5: 8705042860886878f85685e9f2189ec2
      size: 227255
    - path: data/processed/val_y.npy
      md5: 9266daa46be4222a08e5249ccc572be4
      size: 25723
    - path: src/stages/to_categorical.py
      md5: 56e2e61ee1e82b3fe07f51c7e6da59e4
      size: 2397
    outs:
    - path: data/processed/test2_y_encoder.npy
      md5: e4753e128f96ab4823edc6b1ec3d4164
      size: 74768
    - path: data/processed/test_y_encoder.npy
      md5: 2d45990cc9bc284a21a214afdd546316
      size: 111320
    - path: data/processed/train_y_encoder.npy
      md5: 4afd9bb748fd96c7d6e4ee2f5a69bee7
      size: 900776
    - path: data/processed/val_y_encoder.npy
      md5: e7e2fa167c673a46883edd02362158e2
      size: 100208
    - path: models/skelet_hand_f19.json
      md5: f7f62bee2f36a3f9b7e828e34d5e4573
      size: 727
  train:
    cmd: python3 src/stages/train.py params.yaml
    deps:
    - path: data/processed/train_x.npy
      md5: a12cc638d1bb3b995d1602d9a208f88f
      size: 17112440
    - path: data/processed/train_y_encoder.npy
      md5: 4afd9bb748fd96c7d6e4ee2f5a69bee7
      size: 900776
    - path: data/processed/val_x.npy
      md5: 93f8d456f4d554d555ee1e0e48254991
      size: 1901648
    - path: data/processed/val_y_encoder.npy
      md5: e7e2fa167c673a46883edd02362158e2
      size: 100208
    - path: src/stages/train.py
      md5: 17efd98b9f1e732052f5b5821232a87b
      size: 3121
    params:
      params.yaml:
        train.epochs: 1200
    outs:
    - path: models/skelet_hand_f19.h5
      md5: 84c1c35f92040c65e310abed69271bcb
      size: 69800
    - path: reports/train_history.csv
      md5: a52f7f732f2fc55512c9150dd9abbb6f
      size: 97823
  predict:
    cmd: python3 src/stages/predict.py params.yaml
    deps:
    - path: data/processed/test2_x.npy
      md5: 0ad4cce2a475e7cf300649df96b2614c
      size: 1418288
    - path: data/processed/test_x.npy
      md5: d1cdcd7086c5f40cc03042ff4ac7f8c7
      size: 2112776
    - path: data/processed/train_x.npy
      md5: a12cc638d1bb3b995d1602d9a208f88f
      size: 17112440
    - path: data/processed/val_x.npy
      md5: 93f8d456f4d554d555ee1e0e48254991
      size: 1901648
    - path: models/skelet_hand_f19.h5
      md5: 84c1c35f92040c65e310abed69271bcb
      size: 69800
    - path: src/stages/predict.py
      md5: d9b5fdae0131b7d8eaa753a5b3b239b4
      size: 4356
    outs:
    - path: data/processed/test2_y_pred.npy
      md5: e6fa7605e152062d8a2baade0bbd7872
      size: 149408
    - path: data/processed/test2_y_pred_proba.npy
      md5: b699096d13a8b61262492860e2079636
      size: 1642208
    - path: data/processed/test_y_pred.npy
      md5: f62c43f3c42a794587e7d6eac9bc3c8c
      size: 222512
    - path: data/processed/test_y_pred_proba.npy
      md5: fcb07bb5b75f80f259819f344f4c4d0d
      size: 2446352
    - path: data/processed/train_y_pred.npy
      md5: edf8fc028ecf8a6ce2ffba64d8adbf32
      size: 1801424
    - path: data/processed/train_y_pred_proba.npy
      md5: 1be1159cc0fa037de509b59278388741
      size: 19814384
    - path: data/processed/val_y_pred.npy
      md5: d96127ec2069511d57ec08509dac7cbf
      size: 200288
    - path: data/processed/val_y_pred_proba.npy
      md5: 02388b0e50b480567f980b43ed25386a
      size: 2201888
  evaluate:
    cmd: python3 src/stages/evaluate.py params.yaml
    deps:
    - path: data/processed/test2_y.npy
      md5: 686ebec95d4f9c235509b9792f7cf49f
      size: 19357
    - path: data/processed/test2_y_pred.npy
      md5: e6fa7605e152062d8a2baade0bbd7872
      size: 149408
    - path: data/processed/test2_y_pred_proba.npy
      md5: b699096d13a8b61262492860e2079636
      size: 1642208
    - path: data/processed/test_y.npy
      md5: b1d20d41787b0d2b1e8ba8e667d47fee
      size: 28503
    - path: data/processed/test_y_pred.npy
      md5: f62c43f3c42a794587e7d6eac9bc3c8c
      size: 222512
    - path: data/processed/test_y_pred_proba.npy
      md5: fcb07bb5b75f80f259819f344f4c4d0d
      size: 2446352
    - path: data/processed/train_y.npy
      md5: 8705042860886878f85685e9f2189ec2
      size: 227255
    - path: data/processed/train_y_pred.npy
      md5: edf8fc028ecf8a6ce2ffba64d8adbf32
      size: 1801424
    - path: data/processed/train_y_pred_proba.npy
      md5: 1be1159cc0fa037de509b59278388741
      size: 19814384
    - path: data/processed/val_y.npy
      md5: 9266daa46be4222a08e5249ccc572be4
      size: 25723
    - path: data/processed/val_y_pred.npy
      md5: d96127ec2069511d57ec08509dac7cbf
      size: 200288
    - path: data/processed/val_y_pred_proba.npy
      md5: 02388b0e50b480567f980b43ed25386a
      size: 2201888
    - path: src/stages/evaluate.py
      md5: 64fc67e2701ad4b10ad50217913a608b
      size: 9018
    outs:
    - path: reports/test.json
      md5: e7122c97762906c4e4bcc3f487698d4a
      size: 30
    - path: reports/test2.json
      md5: b75c350ccab070934741f61b25afdf84
      size: 31
    - path: reports/train.json
      md5: 8e765bd96f92929761bf98bc22ccb1a7
      size: 31
    - path: reports/val.json
      md5: f97d2044633bd53fffb773c40c09c04b
      size: 31
  app:
    cmd: python3 src/stages/app.py params.yaml
    deps:
    - path: data/raw/sl_hand
      md5: cfb3e3adb87ae3d064a5791e736a6658.dir
      size: 282910552
      nfiles: 32
    - path: models/skelet_hand_f19.h5
      md5: 84c1c35f92040c65e310abed69271bcb
      size: 69800
    - path: models/skelet_hand_f19.json
      md5: f7f62bee2f36a3f9b7e828e34d5e4573
      size: 727
    - path: src/stages/app.py
      md5: 2272564d30a3ab105969eee7615825e4
      size: 2805
    outs:
    - path: reports/app.json
      md5: 0b006023d8c342e8c184d0e21a12962e
      size: 54
  reduce_label:
    cmd: python3 src/stages/reduce_label.py params.yaml
    deps:
    - path: data/interim/angle_19f_handshape.csv
      md5: 595864f2a50e16c60705c396cce39a30
      size: 26172372
    - path: data/raw/fsw_handshape.json
      md5: a8dafa55e11fd34e5659fd1e83ad0c98
      size: 1714
    - path: src/stages/reduce_label.py
      md5: caba32dcca9162e450614bceaf749e17
      size: 2984
    outs:
    - path: data/interim/reduce_label.csv
      md5: 9e630fc184634a8009ef8ad07e77df1a
      size: 26172372
  split_by_folder:
    cmd: python3 src/stages/split_by_folder.py params.yaml
    deps:
    - path: data/interim/reduce_label.csv
      md5: 9e630fc184634a8009ef8ad07e77df1a
      size: 26172372
    - path: src/stages/split_by_folder.py
      md5: 13984d5af8ad4cd83fe505cf58673fc8
      size: 1046
    outs:
    - path: data/interim/test2.csv
      md5: 513bcef6a9da6cc91534b35130f972b5
      size: 1664613
    - path: data/interim/train_val_test.csv
      md5: f8807f02aff0b3e521a1f47540d2dbc9
      size: 24508067
  make_imbalance:
    cmd: python3 src/stages/make_imbalance.py params.yaml
    deps:
    - path: data/interim/train_val_test.csv
      md5: f8807f02aff0b3e521a1f47540d2dbc9
      size: 24508067
    - path: src/stages/make_imbalance.py
      md5: adb4dda59ee17dd8b28a814f01281a79
      size: 5320
    params:
      params.yaml:
        make_imbalance.method: undersampling_EditedNearestNeighbours
    outs:
    - path: data/interim/train_val_test_balance.csv
      md5: a6048a8f9429c1fc56f08f1ecb5f2d7d
      size: 18888758
